FROM openjdk:8-jre-alpine

# Add Jolokia
ADD https://repo1.maven.org/maven2/org/jolokia/jolokia-jvm/1.3.7/jolokia-jvm-1.3.7-agent.jar /
RUN mv /jolokia-jvm-*.jar /jolokia.jar

# Add our JAR
COPY test-server.jar /

EXPOSE 8080 8778
ENTRYPOINT ["java", "-XX:+UnlockExperimentalVMOptions", "-XX:+UseCGroupMemoryLimitForHeap", "-javaagent:/jolokia.jar=port=8778,host=0.0.0.0", "-jar", "/test-server.jar"]
# You can add "-XX:+PrintFlagsFinal" to print result options and "-XX:MaxRAMPercentage=75" for Java10+ 
